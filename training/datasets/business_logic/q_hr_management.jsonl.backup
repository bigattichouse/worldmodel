{"id": "q_hr_101", "category": "hr_management", "difficulty": "intermediate", "user_query": "Employee onboarding workflow", "response": "<thinking>\nPROBLEM UNDERSTANDING:\n- Need to manage employee onboarding with multiple steps and stakeholders\n- Should handle document collection, system access setup, and orientation scheduling\n- Must ensure compliance with legal requirements and company policies\n- Should track progress and send automated reminders\n\nSTRATEGIC APPROACH:\n- Create an EmployeeOnboarding service with workflow management\n- Implement multi-step onboarding process with dependencies\n- Support document management and digital signatures\n- Include automated notifications and progress tracking\n- Ensure compliance with employment laws and regulations\n\nDESIGN PREPARATION:\n- Core operations: initiateOnboarding, completeStep, trackProgress\n- Onboarding workflow with configurable steps\n- Document management and compliance tracking\n- Notification system for stakeholders\n</thinking>\n\n<blueprint>\nService EmployeeOnboarding {\n  description: \"Manages employee onboarding workflow with document management and compliance tracking\",\n  \n  dependencies: {\n    storage: OnboardingDatabase,\n    documents: DocumentManagement,\n    auth: AccessManagement,\n    notifications: NotificationService,\n    compliance: ComplianceTracker\n  },\n  \n  methods: {\n    initiateOnboarding(employeeDetails: NewEmployeeRequest) -> OnboardingProcess {\n      preconditions: [valid employee details, required fields provided],\n      postconditions: [onboarding process created, initial tasks assigned],\n      errors: [InvalidEmployeeDetails]\n    },\n    \n    completeStep(processId: ProcessId, stepId: StepId, completedBy: UserId, evidence: Evidence?) -> StepCompletionResult {\n      preconditions: [step exists, process active, user authorized],\n      postconditions: [step marked complete, next steps unlocked if applicable],\n      errors: [StepNotFound, ProcessInactive, UnauthorizedAccess]\n    },\n    \n    uploadDocument(processId: ProcessId, stepId: StepId, document: DocumentUpload) -> DocumentUploadResult {\n      preconditions: [process active, step allows document upload],\n      postconditions: [document stored securely, linked to onboarding process]\n    },\n    \n    trackProgress(processId: ProcessId) -> ProgressReport {\n      preconditions: [process exists],\n      postconditions: [returns current status of all onboarding steps]\n    },\n    \n    getOnboardingTasks(assigneeId: UserId) -> OnboardingTask[] {\n      preconditions: [user exists],\n      postconditions: [returns pending onboarding tasks assigned to user]\n    },\n    \n    generateOnboardingChecklist(employeeId: EmployeeId, department: string) -> OnboardingChecklist {\n      preconditions: [employee exists, department valid],\n      postconditions: [returns customized checklist for role/dept]\n    }\n  }\n}\n\nDatabase OnboardingDatabase {\n  Table Employees {\n    columns: {\n      id: {type: UUID, primaryKey: true},\n      employee_id: {type: String, unique: true, required: true, maxLength: 20},\n      first_name: {type: String, required: true, maxLength: 50},\n      last_name: {type: String, required: true, maxLength: 50},\n      email: {type: String, unique: true, required: true, maxLength: 100},\n      position: {type: String, required: true, maxLength: 100},\n      department: {type: String, required: true, maxLength: 100},\n      start_date: {type: Date, required: true},\n      manager_id: {type: UUID, foreignKey: \"Employees.id\"},\n      status: {type: String, enum: [\"pre_onboarding\", \"onboarding\", \"active\", \"inactive\"], default: \"pre_onboarding\"}\n    },\n    indexes: [\n      {name: \"idx_employee_id\", columns: [\"employee_id\"]},\n      {name: \"idx_email\", columns: [\"email\"]},\n      {name: \"idx_manager\", columns: [\"manager_id\"]}\n    ]\n  },\n  \n  Table OnboardingProcesses {\n    columns: {\n      id: {type: UUID, primaryKey: true},\n      employee_id: {type: UUID, foreignKey: \"Employees.id\", required: true},\n      status: {type: String, enum: [\"initiated\", \"in_progress\", \"completed\", \"delayed\", \"cancelled\"], default: \"initiated\"},\n      start_date: {type: Date, required: true},\n      target_completion_date: {type: Date, required: true},\n      actual_completion_date: {type: Date},\n      created_at: {type: Timestamp, default: \"now()\"},\n      updated_at: {type: Timestamp, default: \"now()\"}\n    },\n    indexes: [\n      {name: \"idx_employee_process\", columns: [\"employee_id\"]},\n      {name: \"idx_status\", columns: [\"status\"]}\n    ]\n  },\n  \n  Table OnboardingSteps {\n    columns: {\n      id: {type: UUID, primaryKey: true},\n      name: {type: String, required: true, maxLength: 100},\n      description: {type: Text},\n      category: {type: String, enum: [\"documentation\", \"compliance\", \"technical\", \"orientation\", \"hr_processes\"]},\n      required: {type: Bool, default: true},\n      estimated_duration_hours: {type: Int, default: 1},\n      depends_on_step_ids: {type: JSON},  // Array of step IDs this step depends on\n      responsible_role: {type: String, maxLength: 50},  // HR, IT, Manager, etc.\n      created_at: {type: Timestamp, default: \"now()\"}\n    }\n  },\n  \n  Table ProcessSteps {\n    columns: {\n      process_id: {type: UUID, foreignKey: \"OnboardingProcesses.id\", required: true},\n      step_id: {type: UUID, foreignKey: \"OnboardingSteps.id\", required: true},\n      status: {type: String, enum: [\"pending\", \"in_progress\", \"completed\", \"skipped\", \"blocked\"], default: \"pending\"},\n      assigned_to: {type: UUID, foreignKey: \"Users.id\"},\n      started_at: {type: Timestamp},\n      completed_at: {type: Timestamp},\n      completed_by: {type: UUID, foreignKey: \"Users.id\"},\n      notes: {type: Text}\n    },\n    indexes: [\n      {name: \"idx_process_step\", columns: [\"process_id\", \"step_id\"]},\n      {name: \"idx_assigned_to\", columns: [\"assigned_to\"]},\n      {name: \"idx_status\", columns: [\"status\"]}\n    ],\n    constraints: [\n      {type: \"primary_key\", columns: [\"process_id\", \"step_id\"]}\n    ]\n  },\n  \n  Table Documents {\n    columns: {\n      id: {type: UUID, primaryKey: true},\n      process_id: {type: UUID, foreignKey: \"OnboardingProcesses.id\", required: true},\n      step_id: {type: UUID, foreignKey: \"OnboardingSteps.id\", required: true},\n      filename: {type: String, required: true, maxLength: 255},\n      file_path: {type: String, required: true, maxLength: 500},\n      file_size: {type: Int},\n      mime_type: {type: String, maxLength: 100},\n      uploaded_by: {type: UUID, foreignKey: \"Users.id\", required: true},\n      uploaded_at: {type: Timestamp, default: \"now()\"},\n      requires_signature: {type: Bool, default: false},\n      signed_at: {type: Timestamp},\n      signed_by: {type: UUID, foreignKey: \"Users.id\"}\n    },\n    indexes: [\n      {name: \"idx_process_document\", columns: [\"process_id\"]}\n    ]\n  },\n  \n  Table Notifications {\n    columns: {\n      id: {type: UUID, primaryKey: true},\n      process_id: {type: UUID, foreignKey: \"OnboardingProcesses.id\"},\n      recipient_id: {type: UUID, foreignKey: \"Users.id\", required: true},\n      type: {type: String, enum: [\"reminder\", \"completion\", \"deadline\", \"escalation\"], required: true},\n      message: {type: Text, required: true},\n      sent_at: {type: Timestamp, default: \"now()\"},\n      delivered: {type: Bool, default: false},\n      read_at: {type: Timestamp}\n    },\n    indexes: [\n      {name: \"idx_recipient\", columns: [\"recipient_id\"]},\n      {name: \"idx_process_notifications\", columns: [\"process_id\"]}\n    ]\n  },\n  \n  Table Users {\n    columns: {\n      id: {type: UUID, primaryKey: true},\n      username: {type: String, unique: true, required: true, maxLength: 50},\n      email: {type: String, unique: true, required: true, maxLength: 100},\n      role: {type: String, enum: [\"employee\", \"manager\", \"hr\", \"it_admin\", \"admin\"], required: true}\n    }\n  }\n}\n\nType NewEmployeeRequest {\n  firstName: string,\n  lastName: string,\n  email: string,\n  position: string,\n  department: string,\n  startDate: date,\n  managerId: UserId?\n}\n\nType OnboardingProcess {\n  id: ProcessId,\n  employee: Employee,\n  status: ProcessStatus,\n  startDate: date,\n  targetCompletionDate: date,\n  actualCompletionDate: date?,\n  steps: ProcessStep[],\n  progressPercentage: float,\n  createdAt: timestamp,\n  updatedAt: timestamp\n}\n\nType Employee {\n  id: EmployeeId,\n  employeeId: string,\n  firstName: string,\n  lastName: string,\n  email: string,\n  position: string,\n  department: string,\n  startDate: date,\n  manager: Employee?,\n  status: EmployeeStatus\n}\n\nType ProcessStep {\n  step: OnboardingStep,\n  status: StepStatus,\n  assignedTo: User?,\n  startedAt: timestamp?,\n  completedAt: timestamp?,\n  completedBy: User?,\n  notes: string?\n}\n\nType OnboardingStep {\n  id: StepId,\n  name: string,\n  description: string?,\n  category: StepCategory,\n  required: boolean,\n  estimatedDurationHours: int,\n  dependsOnStepIds: StepId[],\n  responsibleRole: string\n}\n\nType StepCompletionResult {\n  processId: ProcessId,\n  stepId: StepId,\n  status: StepStatus,\n  completedBy: User,\n  completedAt: timestamp,\n  nextStepsUnlocked: OnboardingStep[]\n}\n\nType DocumentUpload {\n  filename: string,\n  contentType: string,\n  content: binary,\n  requiresSignature: boolean?\n}\n\nType DocumentUploadResult {\n  documentId: DocumentId,\n  processId: ProcessId,\n  stepId: StepId,\n  filename: string,\n  fileSize: int,\n  uploadedAt: timestamp,\n  requiresSignature: boolean\n}\n\nType ProgressReport {\n  processId: ProcessId,\n  employee: Employee,\n  overallStatus: ProcessStatus,\n  progressPercentage: float,\n  completedSteps: int,\n  totalSteps: int,\n  pendingSteps: OnboardingStep[],\n  overdueSteps: OnboardingStep[],\n  completedStepsList: ProcessStep[],\n  nextMilestones: Milestone[]\n}\n\nType OnboardingTask {\n  id: TaskId,\n  processId: ProcessId,\n  step: OnboardingStep,\n  dueDate: date,\n  status: TaskStatus,\n  priority: Priority\n}\n\nType OnboardingChecklist {\n  employeeId: EmployeeId,\n  department: string,\n  position: string,\n  steps: OnboardingStep[],\n  estimatedTimeline: TimelineEstimate\n}\n\nType Evidence {\n  type: EvidenceType,\n  details: string,\n  attachments: DocumentId[]?\n}\n\nType EvidenceType {\n  enum: [\"document_uploaded\", \"form_submitted\", \"verification_completed\", \"training_completed\", \"access_granted\"]\n}\n\nType ProcessStatus {\n  enum: [\"initiated\", \"in_progress\", \"completed\", \"delayed\", \"cancelled\"]\n}\n\nType StepStatus {\n  enum: [\"pending\", \"in_progress\", \"completed\", \"skipped\", \"blocked\"]\n}\n\nType StepCategory {\n  enum: [\"documentation\", \"compliance\", \"technical\", \"orientation\", \"hr_processes\"]\n}\n\nType TaskStatus {\n  enum: [\"pending\", \"in_progress\", \"completed\", \"overdue\"]\n}\n\nType Priority {\n  enum: [\"low\", \"medium\", \"high\", \"critical\"]\n}\n\nType EmployeeStatus {\n  enum: [\"pre_onboarding\", \"onboarding\", \"active\", \"inactive\"]\n}\n\nType Milestone {\n  name: string,\n  expectedDate: date,\n  completed: boolean\n}\n\nType TimelineEstimate {\n  totalDurationWeeks: int,\n  criticalPathSteps: OnboardingStep[],\n  parallelizableSteps: OnboardingStep[]\n}\n\nValidation OnboardingConstraints {\n  maxProcessDuration: {value: 90, unit: \"days\"},\n  minStepDuration: {value: 1, unit: \"hours\"},\n  maxDocumentsPerStep: {value: 10},\n  requiredSteps: [\"background_check\", \"tax_forms\", \"benefits_enrollment\"]\n}\n\nOperation InitiateOnboarding {\n  type: \"workflow\",\n  inputs: [\"employeeDetails\"],\n  steps: [\n    \"create employee record\",\n    \"create onboarding process with default steps\",\n    \"assign initial tasks to HR and IT\",\n    \"send welcome notification to new employee\",\n    \"schedule orientation session\"\n  ],\n  postconditions: [onboarding process initiated with initial tasks]\n}\n\nTransaction CompleteStep {\n  operations: [\n    {type: \"update\", table: \"ProcessSteps\", where: {process_id: param.processId, step_id: param.stepId}, set: {status: \"completed\", completed_at: \"now()\", completed_by: param.completedBy}},\n    {type: \"create\", table: \"Notifications\", data: {process_id: param.processId, recipient_id: \"get_next_responsible_user()\", type: \"reminder\", message: \"Next onboarding step is ready for completion\"}}\n  ],\n  onError: \"rollback\",\n  postconditions: [step completed, next steps notified]\n}\n\nBehavior OnboardingWorkflow {\n  rules: {\n    automatic_reminders: {frequency: \"daily\", for_overdue_tasks: true},\n    escalation_procedure: {after_days: 3, escalate_to: \"hr_manager\"},\n    compliance_deadlines: {required_before_start_date: [\"background_check\", \"I9_form\"]}\n  },\n  \n  notifications: {\n    welcome_message: \"sent to new employee upon process initiation\",\n    task_assignment: \"sent to responsible party when task is assigned\",\n    deadline_reminder: \"sent 24 hours before task deadline\",\n    completion_confirmation: \"sent when onboarding is completed\"\n  }\n}\n</blueprint>", "validation": {"has_thinking": true, "has_blueprint": true, "thinking_structure": ["problem_understanding", "strategic_approach", "design_preparation"], "blueprint_syntax_valid": true, "blueprint_completeness": ["service_definition", "methods_with_contracts", "database_schema", "types", "validation_rules", "operations", "transactions", "behaviors"]}}
{"id": "q_hr_102", "category": "hr_management", "difficulty": "intermediate", "user_query": "Performance review system", "response": "<thinking>\nPROBLEM UNDERSTANDING:\n- Need to manage performance reviews with cycles, evaluations, and feedback\n- Should handle different review types (self, peer, manager) and rating scales\n- Must ensure proper workflow with approvals and notifications\n- Should support goal tracking and development planning\n\nSTRATEGIC APPROACH:\n- Create a PerformanceReview service with review management\n- Implement review cycles with configurable periods\n- Support multi-rater feedback and competency assessments\n- Include goal tracking and development planning features\n- Provide analytics and reporting capabilities\n\nDESIGN PREPARATION:\n- Core operations: createReviewCycle, submitReview, approveReview\n- Review workflow with multiple stages\n- Competency and goal tracking systems\n- Rating scales and feedback mechanisms\n</thinking>\n\n<blueprint>\nService PerformanceReview {\n  description: \"Manages performance reviews with multi-rater feedback and goal tracking\",\n  \n  dependencies: {\n    storage: ReviewDatabase,\n    notifications: NotificationService,\n    auth: AccessManagement,\n    analytics: ReportingService\n  },\n  \n  methods: {\n    createReviewCycle(cycleDetails: ReviewCycleRequest) -> ReviewCycle {\n      preconditions: [valid cycle details, employees exist],\n      postconditions: [review cycle created, employees enrolled],\n      errors: [InvalidCycleDetails]\n    },\n    \n    assignReviewer(reviewId: ReviewId, reviewerId: UserId, relationship: ReviewRelationship) -> ReviewAssignment {\n      preconditions: [review exists, reviewer exists],\n      postconditions: [reviewer assigned to conduct review]\n    },\n    \n    submitReview(submission: ReviewSubmission) -> ReviewSubmissionResult {\n      preconditions: [reviewer authorized, review window open, valid ratings],\n      postconditions: [review submitted, status updated],\n      errors: [UnauthorizedAccess, ReviewWindowClosed, InvalidRatings]\n    },\n    \n    approveReview(reviewId: ReviewId, approverId: UserId, comments: string?) -> ReviewApprovalResult {\n      preconditions: [review submitted, approver authorized],\n      postconditions: [review approved, employee notified]\n    },\n    \n    getReviewDashboard(employeeId: EmployeeId) -> ReviewDashboard {\n      preconditions: [employee exists],\n      postconditions: [returns review status and upcoming deadlines]\n    },\n    \n    trackGoalProgress(employeeId: EmployeeId, goalId: GoalId, progressUpdate: ProgressUpdate) -> GoalProgressResult {\n      preconditions: [goal exists, employee authorized],\n      postconditions: [goal progress updated, notifications sent if needed]\n    },\n    \n    generateReviewReport(cycleId: CycleId, filters: ReportFilters?) -> ReviewReport {\n      preconditions: [cycle exists],\n      postconditions: [returns analytical report on review outcomes]\n    }\n  }\n}\n\nDatabase ReviewDatabase {\n  Table Employees {\n    columns: {\n      id: {type: UUID, primaryKey: true},\n      employee_id: {type: String, unique: true, required: true, maxLength: 20},\n      first_name: {type: String, required: true, maxLength: 50},\n      last_name: {type: String, required: true, maxLength: 50},\n      email: {type: String, unique: true, required: true, maxLength: 100},\n      position: {type: String, maxLength: 100},\n      department: {type: String, maxLength: 100},\n      manager_id: {type: UUID, foreignKey: \"Employees.id\"},\n      hire_date: {type: Date}\n    },\n    indexes: [\n      {name: \"idx_employee_id\", columns: [\"employee_id\"]},\n      {name: \"idx_manager\", columns: [\"manager_id\"]}\n    ]\n  },\n  \n  Table ReviewCycles {\n    columns: {\n      id: {type: UUID, primaryKey: true},\n      name: {type: String, required: true, maxLength: 100},\n      description: {type: Text},\n      start_date: {type: Date, required: true},\n      end_date: {type: Date, required: true},\n      status: {type: String, enum: [\"planning\", \"in_progress\", \"completed\", \"cancelled\"], default: \"planning\"},\n      review_type: {type: String, enum: [\"annual\", \"mid_year\", \"probation\", \"project\"], required: true},\n      rating_scale: {type: String, enum: [\"three_point\", \"five_point\", \"seven_point\", \"custom\"], default: \"five_point\"},\n      self_review_enabled: {type: Bool, default: true},\n      peer_review_enabled: {type: Bool, default: false},\n      created_at: {type: Timestamp, default: \"now()\"},\n      updated_at: {type: Timestamp, default: \"now()\"}\n    }\n  },\n  \n  Table ReviewAssignments {\n    columns: {\n      id: {type: UUID, primaryKey: true},\n      review_cycle_id: {type: UUID, foreignKey: \"ReviewCycles.id\", required: true},\n      reviewee_id: {type: UUID, foreignKey: \"Employees.id\", required: true},\n      reviewer_id: {type: UUID, foreignKey: \"Employees.id\", required: true},\n      relationship: {type: String, enum: [\"manager\", \"peer\", \"direct_report\", \"self\", \"hr_partner\"], required: true},\n      status: {type: String, enum: [\"assigned\", \"in_progress\", \"submitted\", \"approved\", \"rejected\"], default: \"assigned\"},\n      due_date: {type: Date, required: true},\n      assigned_at: {type: Timestamp, default: \"now()\"},\n      submitted_at: {type: Timestamp},\n      approved_at: {type: Timestamp}\n    },\n    indexes: [\n      {name: \"idx_reviewee_cycle\", columns: [\"reviewee_id\", \"review_cycle_id\"]},\n      {name: \"idx_reviewer_cycle\", columns: [\"reviewer_id\", \"review_cycle_id\"]},\n      {name: \"idx_status\", columns: [\"status\"]}\n    ]\n  },\n  \n  Table Reviews {\n    columns: {\n      id: {type: UUID, primaryKey: true},\n      assignment_id: {type: UUID, foreignKey: \"ReviewAssignments.id\", required: true},\n      overall_rating: {type: Decimal},\n      strengths: {type: Text},\n      areas_for_improvement: {type: Text},\n      goals_discussed: {type: Text},\n      development_plan: {type: Text},\n      reviewer_comments: {type: Text},\n      reviewee_comments: {type: Text},\n      submitted_at: {type: Timestamp},\n      approved_at: {type: Timestamp},\n      approved_by: {type: UUID, foreignKey: \"Employees.id\"}\n    }\n  },\n  \n  Table Competencies {\n    columns: {\n      id: {type: UUID, primaryKey: true},\n      name: {type: String, required: true, maxLength: 100},\n      description: {type: Text},\n      category: {type: String, maxLength: 50},\n      weight: {type: Decimal, default: 1.0},\n      rating_guide: {type: Text}  // Detailed description of rating levels\n    }\n  },\n  \n  Table ReviewCompetencies {\n    columns: {\n      review_id: {type: UUID, foreignKey: \"Reviews.id\", required: true},\n      competency_id: {type: UUID, foreignKey: \"Competencies.id\", required: true},\n      rating: {type: Decimal, required: true},\n      comments: {type: Text}\n    },\n    indexes: [\n      {name: \"idx_review_competency\", columns: [\"review_id\", \"competency_id\"]}\n    ],\n    constraints: [\n      {type: \"primary_key\", columns: [\"review_id\", \"competency_id\"]}\n    ]\n  },\n  \n  Table Goals {\n    columns: {\n      id: {type: UUID, primaryKey: true},\n      employee_id: {type: UUID, foreignKey: \"Employees.id\", required: true},\n      title: {type: String, required: true, maxLength: 200},\n      description: {type: Text},\n      category: {type: String, maxLength: 50},\n      status: {type: String, enum: [\"not_started\", \"in_progress\", \"completed\", \"deferred\", \"cancelled\"], default: \"not_started\"},\n      priority: {type: String, enum: [\"low\", \"medium\", \"high\"], default: \"medium\"},\n      target_date: {type: Date},\n      created_at: {type: Timestamp, default: \"now()\"},\n      updated_at: {type: Timestamp, default: \"now()\"}\n    },\n    indexes: [\n      {name: \"idx_employee_goals\", columns: [\"employee_id\"]}\n    ]\n  },\n  \n  Table GoalProgress {\n    columns: {\n      id: {type: UUID, primaryKey: true},\n      goal_id: {type: UUID, foreignKey: \"Goals.id\", required: true},\n      progress_percentage: {type: Int, min: 0, max: 100, required: true},\n      update_notes: {type: Text},\n      updated_by: {type: UUID, foreignKey: \"Employees.id\", required: true},\n      updated_at: {type: Timestamp, default: \"now()\"}\n    },\n    indexes: [\n      {name: \"idx_goal_progress\", columns: [\"goal_id\", \"updated_at\"]}\n    ]\n  }\n}\n\nType ReviewCycleRequest {\n  name: string,\n  description: string?,\n  startDate: date,\n  endDate: date,\n  reviewType: ReviewType,\n  ratingScale: RatingScale,\n  selfReviewEnabled: boolean?,\n  peerReviewEnabled: boolean?,\n  employeeIds: EmployeeId[]\n}\n\nType ReviewSubmission {\n  assignmentId: AssignmentId,\n  overallRating: float,\n  strengths: string?,\n  areasForImprovement: string?,\n  goalsDiscussed: string?,\n  developmentPlan: string?,\n  reviewerComments: string?,\n  competencyRatings: CompetencyRating[],\n  submittedBy: UserId\n}\n\nType CompetencyRating {\n  competencyId: CompetencyId,\n  rating: float,\n  comments: string?\n}\n\nType ReviewSubmissionResult {\n  assignmentId: AssignmentId,\n  reviewId: ReviewId,\n  status: SubmissionStatus,\n  submittedAt: timestamp\n}\n\nType ReviewApprovalResult {\n  reviewId: ReviewId,\n  status: ApprovalStatus,\n  approvedBy: UserId,\n  approvedAt: timestamp,\n  comments: string?\n}\n\nType ReviewDashboard {\n  employeeId: EmployeeId,\n  currentCycles: ReviewCycle[],\n  assignedReviews: ReviewAssignment[],\n  pendingApprovals: Review[],\n  upcomingDeadlines: Deadline[],\n  historicalReviews: ReviewSummary[]\n}\n\nType ReviewReport {\n  cycleId: CycleId,\n  summaryStats: ReviewStatistics,\n  distributionByRating: RatingDistribution,\n  departmentBreakdown: DepartmentBreakdown[],\n  recommendations: string[]\n}\n\nType ReviewCycle {\n  id: CycleId,\n  name: string,\n  description: string?,\n  startDate: date,\n  endDate: date,\n  status: CycleStatus,\n  reviewType: ReviewType,\n  ratingScale: RatingScale,\n  selfReviewEnabled: boolean,\n  peerReviewEnabled: boolean,\n  totalAssigned: int,\n  completed: int,\n  inProgress: int\n}\n\nType ReviewAssignment {\n  id: AssignmentId,\n  reviewCycle: ReviewCycle,\n  reviewee: Employee,\n  reviewer: Employee,\n  relationship: ReviewRelationship,\n  status: AssignmentStatus,\n  dueDate: date,\n  assignedAt: timestamp,\n  submittedAt: timestamp?,\n  review: Review?\n}\n\nType Review {\n  id: ReviewId,\n  assignment: ReviewAssignment,\n  overallRating: float,\n  strengths: string?,\n  areasForImprovement: string?,\n  goalsDiscussed: string?,\n  developmentPlan: string?,\n  reviewerComments: string?,\n  revieweeComments: string?,\n  competencyRatings: CompetencyRating[],\n  submittedAt: timestamp?,\n  approvedAt: timestamp?\n}\n\nType GoalProgressResult {\n  goalId: GoalId,\n  progressPercentage: int,\n  updateNotes: string?,\n  updatedAt: timestamp\n}\n\nType ReviewStatistics {\n  totalReviews: int,\n  completedReviews: int,\n  averageRating: float,\n  ratingDistribution: Map<string, int>,\n  participationRate: float\n}\n\nType RatingDistribution {\n  rating: string,\n  count: int,\n  percentage: float\n}\n\nType DepartmentBreakdown {\n  department: string,\n  totalReviews: int,\n  averageRating: float,\n  ratingDistribution: RatingDistribution[]\n}\n\nType ReviewSummary {\n  cycleName: string,\n  overallRating: float,\n  completedDate: date,\n  status: AssignmentStatus\n}\n\nType Deadline {\n  task: string,\n  dueDate: date,\n  daysRemaining: int\n}\n\nType ReviewType {\n  enum: [\"annual\", \"mid_year\", \"probation\", \"project\"]\n}\n\nType RatingScale {\n  enum: [\"three_point\", \"five_point\", \"seven_point\", \"custom\"]\n}\n\nType ReviewRelationship {\n  enum: [\"manager\", \"peer\", \"direct_report\", \"self\", \"hr_partner\"]\n}\n\nType AssignmentStatus {\n  enum: [\"assigned\", \"in_progress\", \"submitted\", \"approved\", \"rejected\"]\n}\n\nType SubmissionStatus {\n  enum: [\"submitted\", \"error\"]\n}\n\nType ApprovalStatus {\n  enum: [\"approved\", \"rejected\"]\n}\n\nType CycleStatus {\n  enum: [\"planning\", \"in_progress\", \"completed\", \"cancelled\"]\n}\n\nType ProgressUpdate {\n  progressPercentage: int,\n  updateNotes: string?\n}\n\nType ReportFilters {\n  departments: string[]?,\n  managers: UserId[]?,\n  ratingRange: RatingRange?\n}\n\nType RatingRange {\n  min: float,\n  max: float\n}\n\nValidation ReviewConstraints {\n  minRating: {five_point: 1, seven_point: 1},\n  maxRating: {five_point: 5, seven_point: 7},\n  reviewWindowExtension: {maxDays: 14},\n  competencyWeightsSum: {value: 1.0},\n  reviewDeadline: {beforeCycleEnd: 7, unit: \"days\"}\n}\n\nOperation SubmitReview {\n  type: \"workflow\",\n  inputs: [\"submission\"],\n  steps: [\n    \"validate submission against assignment\",\n    \"verify reviewer authorization\",\n    \"validate rating ranges\",\n    \"save review data\",\n    \"update assignment status to submitted\",\n    \"notify manager of submission\"\n  ],\n  postconditions: [review submitted and assignment updated]\n}\n\nTransaction ApproveReview {\n  operations: [\n    {type: \"update\", table: \"ReviewAssignments\", where: {id: \"get_assignment_id_for_review(param.reviewId)\"}, set: {status: \"approved\"}},\n    {type: \"update\", table: \"Reviews\", where: {id: param.reviewId}, set: {approved_at: \"now()\", approved_by: param.approverId}},\n    {type: \"create\", table: \"Notifications\", data: {recipient_id: \"get_reviewee_id(param.reviewId)\", type: \"completion\", message: \"Your performance review has been approved\"}}\n  ],\n  onError: \"rollback\",\n  postconditions: [review approved, employee notified]\n}\n\nBehavior ReviewWorkflow {\n  rules: {\n    mandatory_fields: {overall_rating: true, strengths: true, areas_for_improvement: true},\n    review_reminders: {first: \"3_days_before_due\", follow_up: \"daily_after_overdue\"},\n    calibration_sessions: {required_for_managers: true, frequency: \"quarterly\"}\n  },\n  \n  notifications: {\n    assignment_notification: \"sent to reviewers when assigned\",\n    completion_reminder: \"sent before deadline\",\n    submission_confirmation: \"sent when review is submitted\",\n    approval_notification: \"sent to reviewee when approved\"\n  }\n}\n</blueprint>", "validation": {"has_thinking": true, "has_blueprint": true, "thinking_structure": ["problem_understanding", "strategic_approach", "design_preparation"], "blueprint_syntax_valid": true, "blueprint_completeness": ["service_definition", "methods_with_contracts", "database_schema", "types", "validation_rules", "operations", "transactions", "behaviors"]}}
{"id": "q_hr_103", "category": "hr_management", "difficulty": "intermediate", "user_query": "Leave request management", "response": "<thinking>\nPROBLEM UNDERSTANDING:\n- Need to manage employee leave requests with approval workflows\n- Should handle different leave types (vacation, sick, personal, etc.)\n- Must track leave balances and prevent overuse\n- Should integrate with calendar and payroll systems\n\nSTRATEGIC APPROACH>\n- Create a LeaveRequestManagement service with request handling\n- Implement leave type definitions with accrual rules\n- Support approval workflows with multiple levels\n- Include leave balance tracking and calendar integration\n- Provide reporting and analytics capabilities\n\nDESIGN PREPARATION:\n- Core operations: submitLeaveRequest, approveRequest, trackBalances\n- Leave type configurations with policies\n- Approval workflow with configurable rules\n- Balance tracking and accrual systems\n</thinking>\n\n<blueprint>\nService LeaveRequestManagement {\n  description: \"Manages employee leave requests with approval workflows and balance tracking\",\n  \n  dependencies: {\n    storage: LeaveDatabase,\n    calendar: CalendarIntegration,\n    payroll: PayrollSystem,\n    notifications: NotificationService,\n    auth: AccessManagement\n  },\n  \n  methods: {\n    submitLeaveRequest(request: LeaveRequest) -> LeaveRequestResult {\n      preconditions: [valid dates, sufficient balance, employee authorized],\n      postconditions: [request submitted, status set to pending],\n      errors: [InsufficientBalance, InvalidDates, UnauthorizedAccess]\n    },\n    \n    approveLeaveRequest(requestId: RequestId, approverId: UserId, comments: string?) -> ApprovalResult {\n      preconditions: [request exists, approver authorized, request pending],\n      postconditions: [request approved, calendar updated, balance deducted],\n      errors: [UnauthorizedAccess, RequestAlreadyProcessed]\n    },\n    \n    rejectLeaveRequest(requestId: RequestId, approverId: UserId, reason: string) -> ApprovalResult {\n      preconditions: [request exists, approver authorized, request pending],\n      postconditions: [request rejected, employee notified],\n      errors: [UnauthorizedAccess, RequestAlreadyProcessed]\n    },\n    \n    getLeaveBalance(employeeId: EmployeeId, leaveTypeId: LeaveTypeId) -> LeaveBalance {\n      preconditions: [employee exists, leave type valid],\n      postconditions: [returns current leave balance]\n    },\n    \n    getLeaveCalendar(employeeId: EmployeeId, startDate: date, endDate: date) -> LeaveCalendar {\n      preconditions: [employee exists, valid date range],\n      postconditions: [returns calendar with scheduled leaves]\n    },\n    \n    accrueLeave(employeeId: EmployeeId, leaveTypeId: LeaveTypeId, amount: float) -> AccrualResult {\n      preconditions: [employee exists, leave type valid, authorized],\n      postconditions: [leave balance updated, accrual recorded]\n    },\n    \n    getPendingApprovals(managerId: UserId) -> LeaveRequest[] {\n      preconditions: [user exists],\n      postconditions: [returns pending requests requiring approval]\n    }\n  }\n}\n\nDatabase LeaveDatabase {\n  Table Employees {\n    columns: {\n      id: {type: UUID, primaryKey: true},\n      employee_id: {type: String, unique: true, required: true, maxLength: 20},\n      first_name: {type: String, required: true, maxLength: 50},\n      last_name: {type: String, required: true, maxLength: 50},\n      email: {type: String, unique: true, required: true, maxLength: 100},\n      department: {type: String, maxLength: 100},\n      manager_id: {type: UUID, foreignKey: \"Employees.id\"},\n      hire_date: {type: Date, required: true}\n    },\n    indexes: [\n      {name: \"idx_employee_id\", columns: [\"employee_id\"]},\n      {name: \"idx_manager\", columns: [\"manager_id\"]}\n    ]\n  },\n  \n  Table LeaveTypes {\n    columns: {\n      id: {type: UUID, primaryKey: true},\n      name: {type: String, unique: true, required: true, maxLength: 50},\n      description: {type: Text},\n      unit: {type: String, enum: [\"hours\", \"days\"], default: \"days\"},\n      accrual_rate: {type: Decimal},  // Per pay period or per year\n      max_balance: {type: Decimal},   // Maximum that can accumulate\n      requires_approval: {type: Bool, default: true},\n      approval_hierarchy: {type: JSON},  // Who needs to approve\n      carryover_policy: {type: String, enum: [\"none\", \"partial\", \"full\"]},\n      waiting_period_days: {type: Int, default: 0}  // Days before new employees can use\n    }\n  },\n  \n  Table LeaveBalances {\n    columns: {\n      employee_id: {type: UUID, foreignKey: \"Employees.id\", required: true},\n      leave_type_id: {type: UUID, foreignKey: \"LeaveTypes.id\", required: true},\n      current_balance: {type: Decimal, default: 0},\n      used_current_period: {type: Decimal, default: 0},\n      scheduled_current_period: {type: Decimal, default: 0},\n      last_accrual_date: {type: Date},\n      reset_date: {type: Date}  // When balance resets\n    },\n    indexes: [\n      {name: \"idx_employee_leave_type\", columns: [\"employee_id\", \"leave_type_id\"]}\n    ],\n    constraints: [\n      {type: \"primary_key\", columns: [\"employee_id\", \"leave_type_id\"]}\n    ]\n  },\n  \n  Table LeaveRequests {\n    columns: {\n      id: {type: UUID, primaryKey: true},\n      employee_id: {type: UUID, foreignKey: \"Employees.id\", required: true},\n      leave_type_id: {type: UUID, foreignKey: \"LeaveTypes.id\", required: true},\n      start_date: {type: Date, required: true},\n      end_date: {type: Date, required: true},\n      total_duration: {type: Decimal, required: true},  // In leave type's unit\n      reason: {type: Text},\n      status: {type: String, enum: [\"pending\", \"approved\", \"rejected\", \"cancelled\", \"in_progress\"], default: \"pending\"},\n      requested_at: {type: Timestamp, default: \"now()\"},\n      approved_at: {type: Timestamp},\n      approved_by: {type: UUID, foreignKey: \"Employees.id\"},\n      rejected_at: {type: Timestamp},\n      rejected_reason: {type: Text},\n      notes: {type: Text}\n    },\n    indexes: [\n      {name: \"idx_employee_requests\", columns: [\"employee_id\", \"requested_at\"]},\n      {name: \"idx_status\", columns: [\"status\"]},\n      {name: \"idx_dates\", columns: [\"start_date\", \"end_date\"]}\n    ]\n  },\n  \n  Table LeaveAccruals {\n    columns: {\n      id: {type: UUID, primaryKey: true},\n      employee_id: {type: UUID, foreignKey: \"Employees.id\", required: true},\n      leave_type_id: {type: UUID, foreignKey: \"LeaveTypes.id\", required: true},\n      amount: {type: Decimal, required: true},\n      reason: {type: String, enum: [\"regular_accrual\", \"manual_adjustment\", \"carryover\", \"correction\"], required: true},\n      effective_date: {type: Date, required: true},\n      recorded_by: {type: UUID, foreignKey: \"Employees.id\", required: true},\n      notes: {type: Text}\n    },\n    indexes: [\n      {name: \"idx_employee_accruals\", columns: [\"employee_id\", \"effective_date\"]}\n    ]\n  },\n  \n  Table LeaveApprovals {\n    columns: {\n      id: {type: UUID, primaryKey: true},\n      request_id: {type: UUID, foreignKey: \"LeaveRequests.id\", required: true},\n      approver_id: {type: UUID, foreignKey: \"Employees.id\", required: true},\n      approval_level: {type: Int, required: true},  // For multi-level approvals\n      status: {type: String, enum: [\"pending\", \"approved\", \"rejected\"], default: \"pending\"},\n      comments: {type: Text},\n      actioned_at: {type: Timestamp},\n      actioned_by: {type: UUID, foreignKey: \"Employees.id\"}\n    },\n    indexes: [\n      {name: \"idx_request_approvals\", columns: [\"request_id\"]},\n      {name: \"idx_approver\", columns: [\"approver_id\"]}\n    ]\n  }\n}\n\nType LeaveRequest {\n  employeeId: EmployeeId,\n  leaveTypeId: LeaveTypeId,\n  startDate: date,\n  endDate: date,\n  reason: string?,\n  notes: string?\n}\n\nType LeaveRequestResult {\n  requestId: RequestId,\n  employeeId: EmployeeId,\n  leaveTypeId: LeaveTypeId,\n  startDate: date,\n  endDate: date,\n  totalDuration: float,\n  status: RequestStatus,\n  requestedAt: timestamp\n}\n\nType ApprovalResult {\n  requestId: RequestId,\n  status: RequestStatus,\n  approvedBy: UserId,\n  approvedAt: timestamp,\n  comments: string?\n}\n\nType LeaveBalance {\n  employeeId: EmployeeId,\n  leaveTypeId: LeaveTypeId,\n  leaveType: LeaveType,\n  currentBalance: float,\n  usedCurrentPeriod: float,\n  scheduledCurrentPeriod: float,\n  availableBalance: float\n}\n\nType LeaveCalendar {\n  employeeId: EmployeeId,\n  startDate: date,\n  endDate: date,\n  leaveEvents: LeaveEvent[]\n}\n\nType LeaveEvent {\n  requestId: RequestId,\n  leaveType: LeaveType,\n  startDate: date,\n  endDate: date,\n  status: RequestStatus\n}\n\nType AccrualResult {\n  employeeId: EmployeeId,\n  leaveTypeId: LeaveTypeId,\n  amount: float,\n  newBalance: float,\n  effectiveDate: date,\n  recordedBy: UserId\n}\n\nType LeaveType {\n  id: LeaveTypeId,\n  name: string,\n  description: string?,\n  unit: LeaveUnit,\n  accrualRate: float?,\n  maxBalance: float?,\n  requiresApproval: boolean,\n  carryoverPolicy: CarryoverPolicy,\n  waitingPeriodDays: int\n}\n\nType LeaveUnit {\n  enum: [\"hours\", \"days\"]\n}\n\nType CarryoverPolicy {\n  enum: [\"none\", \"partial\", \"full\"]\n}\n\nType RequestStatus {\n  enum: [\"pending\", \"approved\", \"rejected\", \"cancelled\", \"in_progress\"]\n}\n\nType LeaveBalanceUpdate {\n  employeeId: EmployeeId,\n  leaveTypeId: LeaveTypeId,\n  changeAmount: float,\n  reason: BalanceChangeReason\n}\n\nType BalanceChangeReason {\n  enum: [\"accrual\", \"usage\", \"adjustment\", \"carryover\", \"correction\"]\n}\n\nValidation LeaveConstraints {\n  maxConsecutiveDays: {value: 30},\n  requestWindow: {futureLimit: 365, unit: \"days\"},\n  minimumNotice: {value: 1, unit: \"days\"},\n  maxBalance: {value: 365, unit: \"days\"}\n}\n\nOperation SubmitLeaveRequest {\n  type: \"workflow\",\n  inputs: [\"request\"],\n  steps: [\n    \"validate dates (not in past, within policy)\",\n    \"calculate duration in leave type's unit\",\n    \"check employee has sufficient balance\",\n    \"create leave request record\",\n    \"set status to pending\",\n    \"notify manager for approval\"\n  ],\n  postconditions: [leave request submitted for approval]\n}\n\nTransaction ApproveLeaveRequest {\n  operations: [\n    {type: \"update\", table: \"LeaveRequests\", where: {id: param.requestId}, set: {status: \"approved\", approved_at: \"now()\", approved_by: param.approverId}},\n    {type: \"update\", table: \"LeaveBalances\", where: {employee_id: \"get_employee_id(param.requestId)\", leave_type_id: \"get_leave_type_id(param.requestId)\"}, set: {current_balance: \"current_balance - get_request_duration(param.requestId)\", used_current_period: \"used_current_period + get_request_duration(param.requestId)\"}},\n    {type: \"create\", table: \"CalendarEvents\", data: {employee_id: \"get_employee_id(param.requestId)\", title: \"Approved Leave\", start_date: \"get_start_date(param.requestId)\", end_date: \"get_end_date(param.requestId)\"}}\n  ],\n  onError: \"rollback\",\n  postconditions: [request approved, balance updated, calendar event created]\n}\n\nBehavior LeaveManagement {\n  rules: {\n    blackout_periods: {prevent_leaves: [\"dec_24_to_jan_2\", \"company_holidays\"]},\n    approval_hierarchy: {manager_approval_required: true, hr_secondary_approval: \"for_more_than_5_days\"},\n    accrual_calculation: {based_on_employment_terms_and_tenure: true}\n  },\n  \n  notifications: {\n    request_submitted: \"notify manager when leave is requested\",\n    request_approved: \"notify employee when leave is approved\",\n    request_rejected: \"notify employee when leave is rejected\",\n    balance_low_warning: \"notify employee when leave balance is low\"\n  }\n}\n</blueprint>", "validation": {"has_thinking": true, "has_blueprint": true, "thinking_structure": ["problem_understanding", "strategic_approach", "design_preparation"], "blueprint_syntax_valid": true, "blueprint_completeness": ["service_definition", "methods_with_contracts", "database_schema", "types", "validation_rules", "operations", "transactions", "behaviors"]}}
</content>